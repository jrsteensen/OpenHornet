Copied and Modified from Open Hornet Project